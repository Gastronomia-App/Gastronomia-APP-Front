<section class="biz-modal-root" tabindex="0">
    <div class="biz-overlay" (click)="onCancel()"></div>

    <div class="biz-dialog" (click)="$event.stopPropagation()">
        <!-- Header -->
        <header class="biz-dlg-header">
            <div class="biz-hdr">
                <h2>Editar información del negocio</h2>
                <p>Actualiza los datos generales y la ubicación de tu negocio.</p>
            </div>

            <button class="biz-icon-btn" type="button" aria-label="Cerrar" (click)="onCancel()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </header>

        <form class="biz-dlg-body" [formGroup]="form" (ngSubmit)="onSubmit()">

            <!-- ========== Datos del negocio ========== -->
            <section class="biz-section">
                <div class="biz-section-title">
                    <div class="biz-pill">
                        <svg viewBox="0 0 24 24" aria-hidden="true">
                            <path
                                d="M8 3h8a1 1 0 0 1 1 1v16H7V4a1 1 0 0 1 1-1Zm1 4v2h2V7H9Zm0 4v2h2v-2H9Zm0 4v2h2v-2H9Zm6-8h-2v2h2V7Zm-2 4v2h2v-2h-2Z" />
                        </svg>
                    </div>
                    <span>Datos del negocio</span>
                </div>

                <div class="biz-grid-2">
                    <!-- Nombre -->
                    <label class="biz-field">
                        <span class="biz-label">
                            <svg class="biz-label-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                                <!-- Storefront -->
                                <path d="M4 10.5V19a1.5 1.5 0 0 0 1.5 1.5h13A1.5 1.5 0 0 0 20 19v-8.5" />
                                <path d="M5 10.5h14" />
                                <path d="M8 10.5V6.5A1.5 1.5 0 0 1 9.5 5h5A1.5 1.5 0 0 1 16 6.5v4" />
                                <path d="M10 18h4v-3.5h-4z" />
                            </svg>
                            Nombre del negocio
                        </span>

                        <div class="biz-input" [class.biz-error-border]="hasError('name')">
                            <input type="text" formControlName="name"
                                [placeholder]="business?.name || 'Nombre del negocio'" autocomplete="off" />
                        </div>

                        @if (hasError('name')) {
                        <small class="biz-error">
                            {{ getErrorMessage('name') }}
                        </small>
                        }
                    </label>

                    <!-- CUIT -->
                    <label class="biz-field">
                        <span class="biz-label">
                            <svg class="biz-id-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <rect x="3" y="5" width="18" height="14" rx="2"></rect>
                                <path d="M7 9h10"></path>
                                <path d="M7 13h4"></path>
                            </svg>
                            CUIT
                        </span>

                        <div class="biz-input" [class.biz-error-border]="hasError('cuit')">
                            <input type="text" formControlName="cuit"
                                [placeholder]="business?.cuit || 'CUIT del negocio'" autocomplete="off" />
                        </div>

                        @if (hasError('cuit')) {
                        <small class="biz-error">
                            {{ getErrorMessage('cuit') }}
                        </small>
                        }
                    </label>
                </div>
            </section>

            <div class="biz-divider"></div>

            <!-- ========== Dirección ========== -->
            <section class="biz-section">
                <div class="biz-section-title">
                    <div class="biz-pill">
                        <svg viewBox="0 0 24 24" aria-hidden="true">
                            <path
                                d="M12 2a7 7 0 0 0-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 0 0-7-7Zm0 9.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5Z" />
                        </svg>
                    </div>
                    <span>Dirección del negocio</span>
                </div>

                <div class="biz-grid-2">
                    <!-- Calle -->
                    <label class="biz-field">
                        <span class="biz-label">
                            <svg class="biz-label-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                                <!-- Road -->
                                <path d="M5 4h14" />
                                <path d="M5 20h14" />
                                <path d="M12 4v3" />
                                <path d="M12 10.5v3" />
                                <path d="M12 17v3" />
                            </svg>
                            Calle
                        </span>

                        <div class="biz-input" [class.biz-error-border]="hasError('street')">
                            <input type="text" formControlName="street"
                                [placeholder]="business?.address?.street || 'Calle y número'" autocomplete="off" />
                        </div>

                        @if (hasError('street')) {
                        <small class="biz-error">
                            {{ getErrorMessage('street') }}
                        </small>
                        }
                    </label>

                    <!-- Ciudad -->
                    <label class="biz-field">
                        <span class="biz-label">
                            <svg class="biz-label-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                                <!-- Skyline -->
                                <path d="M4 20h16" />
                                <rect x="5" y="11" width="3" height="6" rx="0.5" />
                                <rect x="10.5" y="9" width="3" height="8" rx="0.5" />
                                <rect x="16" y="7" width="3" height="10" rx="0.5" />
                                <path d="M11.5 7V5.2L13 4l1.5 1.2V7" />
                            </svg>
                            Ciudad
                        </span>

                        <div class="biz-input" [class.biz-error-border]="hasError('city')">
                            <input type="text" formControlName="city"
                                [placeholder]="business?.address?.city || 'Ciudad'" autocomplete="off" />
                        </div>

                        @if (hasError('city')) {
                        <small class="biz-error">
                            {{ getErrorMessage('city') }}
                        </small>
                        }
                    </label>
                </div>

                <div class="biz-grid-2">
                    <!-- Provincia -->
                    <label class="biz-field">
                        <span class="biz-label">
                            <svg class="biz-label-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                                <!-- Map marker / region -->
                                <path
                                    d="M12 3a6 6 0 0 0-6 6c0 3.8 3.5 7.7 5.3 9.5a1 1 0 0 0 1.4 0C14.5 16.7 18 12.8 18 9a6 6 0 0 0-6-6z" />
                                <circle cx="12" cy="9" r="2.1" />
                            </svg>
                            Provincia
                        </span>

                        <div class="biz-input" [class.biz-error-border]="hasError('province')">
                            <input type="text" formControlName="province"
                                [placeholder]="business?.address?.province || 'Provincia'" autocomplete="off" />
                        </div>

                        @if (hasError('province')) {
                        <small class="biz-error">
                            {{ getErrorMessage('province') }}
                        </small>
                        }
                    </label>

                    <!-- Código postal -->
                    <label class="biz-field">
                        <span class="biz-label">
                            <svg class="biz-label-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                                <!-- Envelope + stamp -->
                                <rect x="3.5" y="7" width="17" height="11" rx="2" />
                                <path d="M4.5 8.5l7.5 5 7.5-5" />
                                <rect x="15" y="3.8" width="4" height="4" rx="1" />
                            </svg>
                            Código postal
                        </span>

                        <div class="biz-input" [class.biz-error-border]="hasError('zipCode')">
                            <input type="text" formControlName="zipCode"
                                [placeholder]="business?.address?.zipCode || 'Código postal'" autocomplete="off" />
                        </div>

                        @if (hasError('zipCode')) {
                        <small class="biz-error">
                            {{ getErrorMessage('zipCode') }}
                        </small>
                        }
                    </label>
                </div>
            </section>

            <!-- Footer -->
            <footer class="biz-dlg-footer">
                <button type="button" class="biz-btn biz-btn-ghost" (click)="onCancel()">
                    Cancelar
                </button>

                <button type="submit" class="biz-btn biz-btn-primary" [disabled]="form.invalid">
                    Guardar cambios del negocio
                </button>
            </footer>
        </form>
    </div>
</section>