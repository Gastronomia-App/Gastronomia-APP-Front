
<div class="page-container">
  <div class="page-content">
    @if (loading()) {
      <p>Cargando ubicaciones...</p>
    } @else if (error()) {
      <p class="error">{{ error() }}</p>
    } @else {
      <app-seating-grid-editor
        #gridEditor
        [seatingsInput]="seatings()"
        [draftSeat]="draftSeating()"
        [editedSeat]="selectedSeating()"
        (draftRequested)="onDraftRequested($event)"
        (editRequested)="onEditFromGrid($event)"
        (moveRequested)="onMoveRequested($event)"
        (shapeSizeRequested)="onShapeSizeRequested($event)"
        (liveChange)="onFormChanged($event)"
        (draftClear)="onDraftCleared()"
        (deleteRequested)="onDeleteRequested($event)">
      </app-seating-grid-editor>
    }
  </div>

  <!-- Panel lateral -->
  <aside class="aside-panel seating-aside">
    @if (draftSeating()) {
      <app-seating-form
        [seating]="draftSeating()!"
        mode="create"
        (closed)="onFormClosed()"
        (changed)="onFormChanged($event)">
      </app-seating-form>
    } @else if (selectedSeating()) {
      <app-seating-form
        [seating]="selectedSeating()!"
        mode="edit"
        (closed)="onFormClosed()"
        (changed)="onFormChanged($event)">
      </app-seating-form>
    } @else {
  <div class="aside-panel-wrapper">
    <div class="aside-panel-header">
      <h2>Configuraci√≥n del sal√≥n</h2>
    </div>

    <div class="aside-panel-container">
      <section>
        <p class="text-muted">
          Configur√° la disposici√≥n, forma y tama√±o de las ubicaciones.  
          Seleccion√° una ubicaci√≥n o hac√© clic en una celda vac√≠a para crear una nueva.
        </p>

        <!-- Control de Zoom funcional -->
        <div class="zoom-control">
          <label for="zoomButtons">Nivel de Zoom</label>
          <div class="zoom-buttons" id="zoomButtons">
            <button type="button" (click)="decreaseZoom()" [disabled]="zoomLevel() <= 1">‚àí</button>
            <span class="zoom-value">{{ zoomLevel() }}</span>
            <button type="button" (click)="increaseZoom()" [disabled]="zoomLevel() >= 5">+</button>
          </div>
          <p class="text-muted small">
            Ajust√° el nivel de zoom para observar el sal√≥n con mayor o menor detalle.
          </p>
        </div>

        <!-- Acciones -->
        <h3 class="section-title">Acciones disponibles</h3>
        <ul class="info-list">
          <li>
            <span class="icon">‚ûï</span>
            <div>
              <strong>Agregar:</strong>
              <span class="text-muted"> hac√© clic en una celda vac√≠a.</span>
            </div>
          </li>
          <li>
            <span class="icon">üñ±Ô∏è</span>
            <div>
              <strong>Mover:</strong>
              <span class="text-muted"> arrastr√° y solt√° para cambiar posici√≥n.</span>
            </div>
          </li>
          <li>
            <span class="icon">‚öôÔ∏è</span>
            <div>
              <strong>Editar:</strong>
              <span class="text-muted"> hac√© clic en una ubicaci√≥n existente.</span>
            </div>
          </li>
          <li>
            <span class="icon">‚å´</span>
            <div>
              <strong>Eliminar:</strong>
              <span class="text-muted"> seleccion√° y presion√° eliminar.</span>
            </div>
          </li>
        </ul>

        <!-- Reglas -->
        <div class="alert-info">
          <h4>Reglas del modo edici√≥n</h4>
          <ul>
            <li>No se pueden eliminar ubicaciones ocupadas o en facturaci√≥n.</li>
            <li>Los cambios se aplican solo al <strong>guardar</strong>.</li>
            <li>Los cambios no guardados se pierden al salir del modo edici√≥n.</li>
          </ul>
        </div>

        <!-- Tip -->
        <div class="tip-box">
          <span class="emoji">üí°</span>
          <p>Us√° este modo para reorganizar el sal√≥n de forma clara y ordenada.</p>
        </div>
      </section>
    </div>
  </div>
}
  </aside>

  <app-confirmation-modal
    [isVisible]="showDeleteModal()"
    [title]="'Eliminar mesa'"
    [message]="'¬øSeguro que deseas eliminar esta mesa?'"
    [confirmText]="'Eliminar'"
    [cancelText]="'Cancelar'"
    [isDanger]="true"
    (confirm)="confirmDelete()"
    (cancel)="showDeleteModal.set(false)">
  </app-confirmation-modal>
</div>

